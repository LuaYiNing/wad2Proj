<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>

    <!-- axios -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- bootstrap css -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- vue -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- need to npm install chart.js first-->
    <!-- link to home.css for styling  -->
    <link rel="stylesheet" href="home.css">

    <!-- get newest food insecurity news data from news api: -->
    <script>

        const apiKey = ''; // Replace with your actual API key

        axios.get("https://api.thenewsapi.com/v1/news/all?language=en&search=food+wastage|food+insecurity&api_token=" + apiKey)
            .then(response => {
                console.log(response.data);
                let newsArr = response.data.data;

                let news1 = newsArr[0];
                console.log(news1);
                let title1 = news1.title;
                let url1 = news1.url;
                let a1 = document.createElement('a');
                a1.setAttribute('href', url1);
                a1.innerText = title1;
                document.getElementById('news1Title').appendChild(a1);
                let desc1 = news1.description;
                document.getElementById('news1Desc').innerText = desc1;
                let pic1URL = news1.image_url;
                document.getElementById('news1Img').src = pic1URL;

                let news2 = newsArr[1];
                let title2 = news2.title;
                let url2 = news2.url;
                let a2 = document.createElement('a');
                a2.setAttribute('href', url2);
                a2.innerText = title2;
                document.getElementById('news2Title').appendChild(a2);
                let desc2 = news2.description;
                document.getElementById('news2Desc').innerText = desc2;
                let pic2URL = news2.image_url;
                document.getElementById('news2Img').src = pic2URL;

                let news3 = newsArr[2];
                let title3 = news3.title;
                let url3 = news3.url;
                let a3 = document.createElement('a');
                a3.setAttribute('href', url3);
                a3.innerText = title3;
                document.getElementById('news3Title').appendChild(a3);
                let desc3 = news3.description;
                document.getElementById('news3Desc').innerText = desc3;
                let pic3URL = news3.image_url;
                document.getElementById('news3Img').src = pic3URL;
            })
            .catch(error => {
                console.log(error.message);
            });
    </script>
</head>

<body>
    <!-- nav bar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="login.html">Food Hero</a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo02"
            aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
            <ul class="navbar-nav me-auto mt-2 mt-lg-0">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="home.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="recipe-finder.html">Recipe Finder</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href='../folio-2019/src/index.html'>Play</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href='donation-drive.html'>Donation Drives</a>
                </li>
            </ul>
        </div>

        <div class="collapse navbar-collapse justify-content-end" id="navbarTogglerDemo02">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="profile.html" id="userName">Profile</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="login.html">Log Out</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- header -->
    <div class="fullscreen">
        <section class="container-fluid py-4">
            <div class="row align-items-center">
                <!-- Left Section: pic-->
                <div class="col-md-6 d-flex flex-column justify-content-start">
                    <img src="images/hunger.png">
                </div>

                <!-- Right Section: text -->
                <div class="col-md-6 text-center text-md-start p-5">
                    <p class="Heading">
                        Nearly <span id="important">one in 11 people</span> around the world go to bed hungry every
                        night
                    </p>
                    <p class="Title">
                        Explore our website to learn more about food insecurity around the world,
                        find recipes with your leftovers,
                        and play our interactive games to be a <span id="important">Food Hero</span>!
                    </p>
                </div>
            </div>
        </section>
    </div>

    <!-- chart -->
    <div class="section fade-in">
        <section class="container-fluid py-4">
            <div class="row align-items-center">
                <div class="col-md-4 d-flex flex-column justify-content-start">
                    <p class="Heading-2">
                        A Glimpse into Global Hunger Crisis
                    </p>
                    <p class="Text-2">
                        Discover the staggering numbers of people
                        facing severe food insecurity across countries worldwide.
                        Explore the regions most impacted by this urgent crisis.
                    </p>

                    <span id="source">
                        Source:<a
                            href="https://www.fsinplatform.org/sites/default/files/resources/files/GRFC2024-MYU-en.pdf">
                            2024 Global Report on Food Crises</a>
                    </span>
                </div>

                <div class="col-md-8 text-center text-md-start p-5">
                    <div>
                        <h6 class="text-center">Increase in # of people facing high levels of acute food insecurity
                            between
                            peak 2023 and mid 2024 ( Millions )</h6>
                        <br>
                        <canvas id="barChart"></canvas>
                        <br>
                        <h5 class="Text-2">From 2023 peak to mid 2024, there has been an increase of at least 1 million
                            people facing high
                            levels
                            of acute food insecurity in countries like Yemen, Ethiopia, Myanmar, Sudan, Nigeria, Malawi,
                            Zimbabwe, and Chad.
                        </h5>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Understanding IPC Scale -->
    <div class="section2 fade-in">
        <section class="container-fluid py-4">
            <div class="row align-items-center">
                <div class="col-md-8 d-flex flex-column justify-content-start">
                    <p class="Heading-2 justify-content-center">
                    <div id="ipcCarousel" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner">
                            <!-- Slide 1: IPC Phase 1 -->
                            <div class="carousel-item active">
                                <div class="d-flex flex-column justify-content-center align-items-center text-success">
                                    <h3>Phase 1: Minimal</h3>
                                    <p>Households are able to meet essential food and non-food needs without engaging in
                                        unsustainable coping strategies.</p>
                                </div>
                            </div>
                            <!-- Slide 2: IPC Phase 2 -->
                            <div class="carousel-item">
                                <div class="d-flex flex-column justify-content-center align-items-center text-warning">
                                    <h3>Phase 2: Stressed</h3>
                                    <p>Households have minimally adequate food consumption but are unable to afford some
                                        essential non-food expenditures without using crisis strategies.</p>
                                </div>
                            </div>
                            <!-- Slide 3: IPC Phase 3 -->
                            <div class="carousel-item">
                                <div
                                    class="d-flex flex-column justify-content-center align-items-center text-warning-emphasis">
                                    <h3>Phase 3: Crisis</h3>
                                    <p>Households face food consumption gaps with high acute malnutrition,
                                        or are only able to meet minimum needs through crisis coping strategies.</p>
                                </div>
                            </div>
                            <!-- Slide 4: IPC Phase 4 -->
                            <div class="carousel-item">
                                <div class="d-flex flex-column justify-content-center align-items-center text-danger">
                                    <h3>Phase 4: Emergency</h3>
                                    <p>Households experience large food consumption gaps resulting in
                                        very high acute malnutrition or extreme loss of livelihood assets.</p>
                                </div>
                            </div>
                            <!-- Slide 5: IPC Phase 5 -->
                            <div class="carousel-item">
                                <div
                                    class="d-flex flex-column justify-content-center align-items-center text-danger-emphasis">
                                    <h3>Phase 5: Catastrophe / Famine</h3>
                                    <p>Households face an extreme lack of food, with starvation, death, destitution,
                                        and very critical levels of acute malnutrition.</p>
                                </div>
                            </div>
                        </div>
                        <!-- Carousel Controls -->
                        <button class="carousel-control-prev" type="button" data-bs-target="#ipcCarousel"
                            data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#ipcCarousel"
                            data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                    </p>
                </div>

                <div class="col-md-4 text-center text-md-start p-5">
                    <p class="Heading-2">
                        Decoding the IPC Acute Food Insecurity Classification: Understanding the Global Hunger Scale
                    </p>
                    <p class="Text-2">
                        Use our interactive carousel to navigate through phases of food insecurity and gain a deeper
                        understanding of global food challenges.
                    </p>
                </div>
            </div>
        </section>
    </div>


    <!-- ipc phase 3 and above doughnut graphs -->
    <div class="container-fluid section fade-in">
        <div class="row">
            <div class="col-4">
                <p class="Heading-2">
                    Global Food Insecurity: Populations in Crisis
                </p>
                <p class="Text-2">
                    Explore the alarming numbers of people enduring high levels of acute food insecurity
                    (Phase 3 and above) in countries around the world.
                </p>

                <span id="source">
                    Source:<a
                        href="https://www.fsinplatform.org/sites/default/files/resources/files/GRFC2023-In-Brief-EN.pdf">
                        2023 Global Report on Food Crises</a>
                </span>
            </div>
            <div class="col-4">
                <h6 class="text-center">Number of people in Yemen with high levels of acute food insecurity(IPC/CH phase
                    3 or above or
                    equivalent) in 2022 ( Millions )</h6>
                <br>
                <canvas id="doughnutChartYemen"></canvas>
                <br>
                <h5 class="Text-2">In 2022, IPC/CH phase3+ took up 55% of the whole population of Yemen.</h5>
            </div>
            <div class="col-4">
                <h6 class="text-center">Number of people in Afghanistan with high levels of acute food insecurity(IPC/CH
                    phase 3 or above or
                    equivalent) in 2022 ( Millions )</h6>
                <br>
                <canvas id="doughnutChartAfghan"></canvas>
                <br>
                <h5 class="Text-2"> In 2022, IPC/CH phase3+ took up 46% of the whole population of Afghanistan.</h5>
            </div>

        </div>
    </div>

    <!-- impacts of food insecurity -->
    <div id="app" class="container-fluid impact-section fade-in">
        <div class="row">
            <div class="col-12 align-items-center">
                <p class="Heading-2">
                    Beyond Empty Plates
                </p>
                <p class="Text-2">
                    Interact with our cards to learn how food insecurity impacts our planet, our communities, and our
                    future.
                </p>
            </div>
        </div>

        <div class="row d-flex align-items-center justify-content-center">
            <div v-for="impact in impacts" class="col-sm-12 col-md-6 col-lg-3 impact-container">
                <div v-if="impact.showPic" @mouseover="impact.showPic=false">
                    <p class="Heading-2">{{ impact.title }}</p>
                    <img class="impact-element" :src="impact.image" :alt="impact.title">
                </div>
                <div v-else @mouseout="impact.showPic = true">
                    <h5 class="impact-text">{{ impact.description }}</h5>
                </div>
            </div>
        </div>
    </div>

    <!-- display 3 latest food insecurity news using data retrieved frm api: -->
    <div class="container-fluid news-section fade-in">
        <div class="row">
            <div class="col-12 align-items-center">
                <p class="Heading-2">
                    Fresh Updates on Food Waste: What's happening now
                </p>
                <p class="Text-2">
                    Read up on the latest news on food wastage and food insecurity around the world.
                </p>
            </div>
        </div>

        <!-- display news links, title, desc and img -->
        <div class="row d-flex align-items-center justify-content-center">
            <div class="col-md-6 col-lg-3 m-auto">
                <div class="card text-center" style="width: 18rem;">
                    <img class="card-img-top" id="news1Img">
                    <div class="card-body">
                        <h5 class="card-title" id="news1Title"></h5>
                        <p class="card-text" id="news1Desc"></p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 m-auto">
                <div class="card text-center" style="width: 18rem;">
                    <img class="card-img-top" id="news2Img">
                    <div class="card-body">
                        <h5 class="card-title" id="news2Title"></h5>
                        <p class="card-text" id="news2Desc"></p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 m-auto">
                <div class="card text-center" style="width: 18rem;">
                    <img class="card-img-top" id="news3Img">
                    <div class="card-body">
                        <h5 class="card-title" id="news3Title"></h5>
                        <p class="card-text" id="news3Desc"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="py-3 my-4">
        <hr>
        <p class="text-center text-muted">&copy; 2024 G7T4. All rights reserved.</p>
        <ul class="nav justify-content-center mb-3">
            <li class="nav-item"><a href="home.html" class="nav-link px-2 text-muted">Home</a></li>
            <li class="nav-item"><a href="recipe-finder.html" class="nav-link px-2 text-muted">Recipe Finder</a></li>
            <li class="nav-item"><a href="profile.html" class="nav-link px-2 text-muted">Play</a></li>
            <li class="nav-item"><a href="marketplace.html" class="nav-link px-2 text-muted">Food Donation Drives</a>
            </li>
        </ul>
    </footer>






    <script>
        const hoverValue = {
            id: 'hoverValue',
            afterDatasetsDraw(chart, args, pluginOptions) {
                const { ctx, data } = chart;
                chart.getActiveElements().forEach((active) => {
                    const value = data.datasets[active.datasetIndex].data[active.index];
                    ctx.save();

                    ctx.textAlign = 'center';
                    ctx.fillText(value, active.element.x, active.element.y);
                    ctx.restore();
                });
            }
        }

        const bar = document.getElementById('barChart');
        new Chart(bar, {
            type: 'bar',
            data: {
                labels: ['Yemen', 'Ethiopia', 'Myanmar', 'Sudan', 'Nigeria', 'Malawi', 'Zimbabwe', 'Chad'],
                datasets: [{
                    label: 'Increase in # of people facing high levels of acute food insecurity between peak 2023 and mid 2024 ( Millions )',
                    data: [1, 2.3, 2.6, 5.3, 6.9, 1.3, 1.5, 1.1],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.3)',
                        'rgba(255, 159, 64, 0.3)',
                        'rgba(255, 205, 86, 0.3)',
                        'rgba(75, 192, 192, 0.3)',
                        'rgba(54, 162, 235, 0.3)',
                        'rgb(0, 0, 139,0.3)',
                        'rgba(153, 102, 255, 0.3)',
                        'rgba(201, 203, 207, 0.3)',
                    ],
                    borderColor: [
                        'rgb(255, 99, 132)',
                        'rgb(255, 159, 64)',
                        'rgb(255, 205, 86)',
                        'rgb(75, 192, 192)',
                        'rgb(54, 162, 235)',
                        'rgb(0, 0, 139)',
                        'rgb(153, 102, 255)',
                        'rgb(201, 203, 207)'
                    ],
                    hoverBackgroundColor: [
                        'white',
                        'white',
                        'white',
                        'white',
                        'white',
                        'white',
                        'white',
                        'white',
                    ],
                    hoverBorderColor: [
                        'white',
                        'white',
                        'white',
                        'white',
                        'white',
                        'white',
                        'white',
                        'white',
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                },
                plugins: {
                    tooltip: {
                        enabled: false
                    },
                    legend: {
                        display: false
                    }
                }
            },
            plugins: [hoverValue]
        }
        );

        const doughnutYemen = document.getElementById('doughnutChartYemen');
        new Chart(doughnutYemen, {
            type: 'doughnut',
            data: {
                labels: ['Phase 3', 'Phase 4', 'Phase 5'],
                datasets: [{
                    data: [11.7, 5.6, 0.031],
                    backgroundColor: ['rgba(153, 102, 255, 0.3)', 'rgba(54, 162, 235, 0.3)', 'rgba(255, 205, 86, 0.3)'],
                    hoverBackgroundColor: ['white', 'white', 'white']
                }]
            },
            options: {
                plugins: {
                    tooltip: {
                        enabled: false
                    }
                }
            },
            plugins: [hoverValue]
        });

        const doughnutAfghan = document.getElementById('doughnutChartAfghan');
        new Chart(doughnutAfghan, {
            type: 'doughnut',
            data: {
                labels: ['Phase 3', 'Phase 4'],
                datasets: [{
                    data: [13.8, 6.1],
                    backgroundColor: ['rgba(255, 99, 132, 0.3)', 'rgba(255, 159, 64, 0.3)'],
                    hoverBackgroundColor: ['white', 'white']
                }]
            },
            options: {
                plugins: {
                    tooltip: {
                        enabled: false
                    }
                }
            },
            plugins: [hoverValue]
        });
    </script>

    <!-- Impacts of food insecurity     -->
    <script>
        Vue.createApp({
            data() {
                return {
                    impacts: [
                        {
                            title: "Health Issue",
                            image: "./images/health-issue.png",
                            description: "Food insecurity can lead to malnutrition, which can cause slower growth in children, weakened immune systems, and increased susceptibility to diseases. Chronic hunger can also contribute to conditions such as anemia, heart disease, and diabetes.",
                            showPic: true
                        },
                        {
                            title: "Social Inequality",
                            image: "./images/social inequality.png",
                            description: "Food insecurity often disproportionately affects marginalized communities, worsening existing inequalities in society and leading to social unrest or migration as people seek more stable sources of food and livelihoods elsewhere.",
                            showPic: true
                        },
                        {
                            title: "Climate Change",
                            image: "./images/climate-changee.png",
                            description: "As climate change intensifies, extreme weather events like droughts, floods, and heatwaves become more frequent, exacerbating food shortages. At the same time, food-insecure regions often rely on unsustainable agricultural practices that contribute to greenhouse gas emissions, further worsening climate change and our environment.",
                            showPic: true
                        },
                        {
                            title: "Loss of Biodiversity",
                            image: "./images/bio-loss.png",
                            description: "The conversion of forests, wetlands, and grasslands into agricultural land due to the pressure to grow more food can severely disrupt ecosystems and lead to the extinction of species.",
                            showPic: true
                        }
                    ]
                }
            }
        }).mount('#app')
    </script>


    <script> //passing username to the nav bar 
        const userName = localStorage.getItem('userName') || 'User';
        document.getElementById('userName').innerText = userName;
    </script>

    <script> // to handle scolling animation

        document.addEventListener("DOMContentLoaded", function () {
            const fadeInSections = document.querySelectorAll(".fade-in");
            const handleScroll = () => {
                fadeInSections.forEach((section) => {
                    const rect = section.getBoundingClientRect();
                    const windowHeight = window.innerHeight || document.documentElement.clientHeight;
                    if (rect.top <= windowHeight - 150) {
                        section.classList.add("fade-in-visible");
                    }
                });
            };

            window.addEventListener("scroll", handleScroll);
            handleScroll();
        });

    </script>

    <!-- bootstrap js-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>